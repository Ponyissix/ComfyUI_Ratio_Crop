# 加载本地 .pth 模型计划

收到，非常清晰。我将直接读取您本地的这些文件。
由于这些文件（如 `groundingdino_swinb_cogcoor.pth`）是原始 PyTorch 权重，且伴随有 `.py` 配置文件（如 `GroundingDINO_SwinB.cfg.py`），这确认了我们需要使用 `groundingdino` 库的加载方式。

## 执行步骤

1.  **扫描本地文件**：
    *   在 `INPUT_TYPES` 中，动态列出 `models/sams` 和 `models/grounding-dino` 下的所有 `.pth` 文件。
    *   为了兼容性，我将尝试从 `folder_paths` 获取这些路径，如果获取不到，则使用相对于 ComfyUI 根目录的硬编码路径推断。

2.  **实现加载逻辑 (混合模式)**：
    *   **优先尝试**：导入 `segment_anything` 和 `groundingdino` 库（如果您环境里有）。
    *   **备选方案**：如果找不到库，我将尝试**内联**一个最小化的 SAM 加载器代码（SAM 代码是纯 Python 的，比较容易内联）。
    *   **GroundingDINO 难点**：如果环境里没有 `groundingdino` 库，加载 `.pth` 几乎是不可能的（因为涉及到复杂的模型定义）。鉴于您有这些文件，我假设您的环境是 ready 的。

3.  **适配逻辑**：
    *   **SAM**: 根据文件名（`vit_h`, `vit_l`, `vit_b`）自动选择模型类型。支持 `hq` 版本。
    *   **GroundingDINO**: 需要读取同目录下的 `.py` 配置文件（如 `GroundingDINO_SwinB.cfg.py`）。我会编写逻辑自动寻找同名的 config 文件。

## 关键修改点
修改 `nodes.py`：
1.  移除 `transformers` 的强制依赖。
2.  添加 `folder_paths.get_filename_list("sams")` (如果 ComfyUI 注册了) 或者手动 `os.listdir`。
3.  在 `auto_crop` 中，根据选中的文件名，构建完整路径并加载。

我将立即开始修改，让节点直接使用您硬盘里的这些宝贝。
